*** Settings ***
Suite Setup                         Preparation
Suite Teardown                      Finish Suite
Library                             SeleniumLibrary
Resource                            ../../../resources/resource.robot
Resource                            ../../../resources/testData.robot

*** Test Cases ***
Invalid Create New Security Group
    Click Element                   css:.btn-primary
    Is Create Security Group
    Element Should Be Disabled      css:.control-button
    Press Key                       id:name_id                 \ue004
    Element Should Be Visible       css:.fa-exclamation-circle > path:nth-child(1) 
    Click Element                   css:.back-link
    Is Security Groups
    Click Element                   css:.btn-primary
    Is Create Security Group
    Click Element                   xpath:/html/body/div/div/div/div/div/div[2]/div/div[3]/div/div/div/div/form/table/tbody/tr[1]/td[1]/input
    Element Should Be Disabled      css:.control-button
    Click Element                   xpath:/html/body/div/div/div/div/div/div[2]/div/div[3]/div/div/div/div/form/table/tbody/tr[2]/td[1]/input
    Element Should Be Disabled      css:.control-button
    Input Text                      id:name_id                  ${security group}
    Element Should Be Enabled       css:.control-button
    Click Element                   css:.back-link
    Is Security Groups

Valid Create New Security Group
    Click Element                   css:.btn-primary
    Is Create Security Group
    Input Text                      id:name_id                  ${security group}
    Click Element                   css:.control-button

Checking New Security Group
    Sleep                           5 second
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[1]/div      ${security group}

Create User With New Security Group
    [Tags]                          Test
    Click Link                      xpath://*[@href="/users"]
    Click Element                   css:.btn-primary
    Input Text                      id:email_id                 ${dynamic email}
    Input Text                      id:firstName_id             ${user first name}
    Input Text                      id:lastName_id              ${user last name}
    Click Element                   css:div.checkbox:nth-child(1) > label:nth-child(1) > input:nth-child(1)
    Go Down
    Click Element                   css:.modal-dialog-ok-button
    Sleep                           4 second
    Number Of Rows U

Checking New User
    [Tags]                          Test
    Sleep                           5 second
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[1]/div      ${dynamic email}
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[2]/div      ${user first name}
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[3]/div      ${user last name}
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[4]/div      A_Warehouse
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[5]/div      ${security group}

Delete User
    [Tags]                          Test
    Click Element                   xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[6]/div/div[2]/button
    Element Text Should Be          xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/table/tbody/tr/td[1]          ${dynamic email}
    Element Text Should Be          xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/table/tbody/tr/td[2]          ${user first name}
    Element Text Should Be          xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/table/tbody/tr/td[3]          ${user last name}
    Element Text Should Be          xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/table/tbody/tr/td[4]          A_Warehouse
    Element Text Should Be          xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/table/tbody/tr/td[5]          ${security group}
    Click Element                   css:button.btn:nth-child(2)
    Sleep                           5 second
    Click Link                      xpath://*[@href="/security-groups"]

Edit Security Group
    Click Element                   ${edit group button}
    Is Edit Security Group
    Click Element                   css:.back-link
    Is Security Groups
    Click Element                   ${edit group button}
    Is Edit Security Group
    Input Text                      id:name_id                  ${edit security group}
    Click Element                   xpath:/html/body/div/div/div/div/div/div[2]/div/div[3]/div/div/div/div/form/table/tbody/tr[1]/td[1]/input
    Click Element                   css:.control-button
    
Checking Edit Security Group
    Sleep                           5 second
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[1]/div      ${edit security group}

Delete Security Group
    Click Element                   ${delete group button}
    Is Delete Security Group
    Click Element                   css:.close
    Sleep                           2 second
    Is Security Groups
    Click Element                   ${delete group button}
    Click Element                   css:.modal-footer > button:nth-child(1)
    Sleep                           2 second
    Is Security Groups
    Click Element                   ${delete group button}
    Element Text Should Be          xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/table/tbody/tr/td     ${edit security group}
    Click Element                   css:button.btn:nth-child(2)
    Sleep                           7 second

Sorting Security Groups
    [Tags]                          Sorting
    Sorting Column                  1

Filter Security Groups
    [Tags]                          Filter
    Click Element                   css:.button-right-margin
    Input Text                      css:.form-control           srx-distributor-users
    Click Element                   css:button.btn:nth-child(2)
    Sleep                           5 second
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[1]/td[1]/div     srx-distributor-users
    Number Of Rows
    Should Be Equal                 "${number of row}"      "1"

*** Keywords ***
Preparation
    Goto Security Groups
    Number Of Rows
    ${number of new row}=           Evaluate                    ${number of row}+1
    Set Global Variable             ${number of new row}
    Set Global Variable             ${edit group button}        xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[2]/div/div[1]/button
    Set Global Variable             ${delete group button}      xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${number of new row}]/td[2]/div/div[2]/button

Is Create Security Group
    Element Text Should Be          css:.security-groups-create-update-header > h1:nth-child(1)            Create security group

Is Edit Security Group
    Element Text Should Be          css:.security-groups-create-update-header > h1:nth-child(1)            Edit security group

Is Delete Security Group
    Element Text Should Be          css:.modal-title                                                       Removal Confirmation

Number Of Rows
    ${number of row}                Get Element Count           xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr
    Set Global Variable             ${number of row}

Number Of Rows U
    ${number of row u}              Get Element Count           xpath:/html/body/div/div/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr
    Set Global Variable             ${number of row u}

Go Down
    Click Element                   css:.Select-control
    Press Key                       xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/form/div/div[4]/div/div/div/span[1]/div[2]            \ue015
    Press Key                       xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/form/div/div[4]/div/div/div/span[1]/div[2]            \ue007
    ${text buffer sub}              Get Text                                    xpath:/html/body/div[2]/div[2]/div/div/div[2]/div/form/div/div[4]/div/div/div/span[1]/div[1]/span
    Sleep                           1 second
    Run Keyword If                  "${security group}"!="${text buffer sub}"   Go Down
