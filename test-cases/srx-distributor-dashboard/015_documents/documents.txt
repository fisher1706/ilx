*** Settings ***
Suite Setup                         Preparation
Suite Teardown                      Finish Suite
Library                             SeleniumLibrary
Resource                            ../../../resources/resource.robot
Resource                            ../../../resources/testData.robot

*** Test Cases ***
Check Document Status In Settings
    Goto Documents
    Is Documents
    ${status}                       Get Text        xpath:/html/body/div/div/div/div/div/div[2]/div/div/div/div/div/div[4]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[1]/td[4]/div/span
    Set Global Variable             ${status}

Check Document Status In Documents
    Goto Documents Sub
    Sleep                           2 second
    Click Element                   css:#pageDropDown
    Sleep                           1 second
    Click Element                   css:li.dropdown-item:nth-child(4) > a:nth-child(1)
    Sleep                           5 second
    Number Of Rows
    :FOR    ${colomn}               IN RANGE        1       ${number of row}+1
    \   ${text buffer}              Get Text    xpath:/html/body/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${colomn}]/td[2]/div
    \   Run Keyword If              "${text buffer}"=="${status}"   Exit For Loop
    \   Set Global Variable         ${colomn}
    Element Text Should Be          xpath:/html/body/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${colomn}]/td[5]/div/span    ${status}

Change Document Status
    Run Keyword If                  "${status}"=="APPROVED"     Approved    ELSE IF     "${status}"=="REJECTED"     Rejected  
    Sleep                           10 second
    Element Text Should Be          xpath:/html/body/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${colomn}]/td[5]/div/span    ${restatus}
    Finish Suite
    Sleep                           5 second

Second Check Document Status In Settings
    Preparation
    Goto Documents
    Is Documents
    Element Text Should Be          xpath:/html/body/div/div/div/div/div/div[2]/div/div/div/div/div/div[4]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[1]/td[4]/div/span     ${restatus}

*** Keywords ***
Preparation
    Goto Settings

Goto Documents
    Click Element                   id:settings-tab-documents
    Sleep                           3 second

Approved
    Click Element                   xpath:/html/body/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${colomn}]/td[6]/div/div[2]/button
    Set Global Variable             ${restatus}                 REJECTED

Rejected
    Click Element                   xpath:/html/body/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr[${colomn}]/td[6]/div/div[1]/button
    Set Global Variable             ${restatus}                 APPROVED

Is Documents
    Element Should Be Visible       id:settings-pane-documents

Goto Documents Sub
    Finish Suite
    Run Keyword If                  "${browser}"=="xvfb"            Run Xvfb Sub    ELSE IF     "${browser}"=="chrome"      Run Chrome Sub      ELSE    Run Ff Sub
    Set Selenium Implicit Wait                                      20 second
    Set Selenium Timeout                                            10 second
    Enter Correct Email Sub
    Enter Password
    Correct Submit Login
    Sleep                           7 second
    Click Element                   css:li.sidebar-item:nth-child(3) > a:nth-child(1)
    Sleep                           3 second

Run Xvfb Sub
    Start Virtual Display           1920                            1080
    Open Browser                    https://admin-dev.storeroomlogix.com/sign-in
    Set Window Size                 1920                            1080

Run Chrome Sub
    Open Browser                    https://admin-dev.storeroomlogix.com/sign-in          chrome

Run Ff Sub
    Open Browser                    https://admin-dev.storeroomlogix.com/sign-in          ff

Enter Correct Email Sub
    Input Text                      id:email                        srx-group+dev@agilevision.io

Number Of Rows
    ${number of row}                Get Element Count               xpath:/html/body/div/div/div/div[2]/div/div[2]/div/div/div[3]/div/div/div/div/div[1]/div[2]/table/tbody/tr
    Set Global Variable             ${number of row}